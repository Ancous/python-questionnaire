### Кратко

Декоратор, который перехватывает ошибки и повторяет выполнение функции максимум N раз, позволяет улучшить устойчивость
приложения, обеспечивая повторные попытки выполнения в случае возникновения исключений.

### Развернуто

В Python декораторы — это функции, которые принимают другую функцию и расширяют её функциональность без изменения её
кода. Чтобы создать декоратор, который будет перехватывать ошибки и повторять функцию до N раз, мы можем использовать
следующий подход:

1. **Определение декоратора**
    - Мы создадим декоратор retry, который будет принимать два аргумента: функцию и максимальное количество попыток (N).
    ```Python
    def retry(max_attempts):
        def decorator(func):
            def wrapper(*args, **kwargs):
                for attempt in range(max_attempts):
                    try:
                        return func(*args, **kwargs)
                    except Exception as e:
                        print(f"Ошибка: {e}. Попытка {attempt + 1} из {max_attempts}.")
                raise Exception(f"Функция {func.__name__} не выполнена после {max_attempts} попыток.")
            return wrapper
        return decorator
    ```

2. **Использование декоратора**
    - Декоратор можно использовать для любых функций, которые могут вызывать исключения. Например, создадим функцию,
      которая может случайно выбрасывать исключение:
    ```Python
    import random

    @retry(max_attempts=3)
    def unreliable_function():
        if random.choice([True, False]):
            raise ValueError("Случайная ошибка!")
        return "Успех!"
    ```

3. **Пример выполнения**
    - При вызове unreliable_function() декоратор будет пытаться выполнить её до 3 раз, пока не получит успешный
      результат или не исчерпает все попытки:
    ```Python
    result = unreliable_function()
    print(result)  # Вывод: "Успех!" или сообщение об ошибке после 3 попыток
    ```

4. **Преимущества и недостатки**
    - Преимущества:
        - Упрощает обработку ошибок и повторные попытки выполнения функций.
        - Повышает устойчивость к временным сбоям.
    - Недостатки:
        - Может скрыть проблемы, если функция постоянно вызывает ошибки.
        - Необходимо учитывать, какие именно ошибки следует перехватывать.

5. **Контекст использования**
    - Такой декоратор полезен в ситуациях, когда функции могут не всегда успешно выполняться, например, при работе с
      сетевыми запросами, доступом к базе данных или другими ненадежными источниками данных.

Таким образом, декоратор retry позволяет перехватывать ошибки и повторять выполнение функции до N раз, улучшая
устойчивость приложения и обеспечивая более надежное выполнение кода.

<div align="right">

[Вернуться к вопросам](../Вопросы.md)

</div>
