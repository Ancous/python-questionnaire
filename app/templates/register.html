<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Регистрация</title>
    <script>
        function hideMessage() {
            setTimeout(() => {
                const message = document.querySelector('.flash-message-register');
                if (message) {
                    message.style.display = 'none';
                }
            }, 2000);
        }
        window.onload = function() {
            hideMessage();
        }
    </script>
    <link
        rel="icon"
        href="../static/images/favicon.jpg"
        type="image/svg+xml">
    <link
        rel="stylesheet"
        href="../static/css/style.css">
</head>
<header>
    <div>
        <h1>
            Вопросики к собеседованию на Python
        </h1>
    </div>
</header>
<body>
<h2>
    Регистрация
</h2>
<div>
    <form action="http://localhost:5000" method="get">
        <button type="submit">
            Вернуться на главную
        </button>
    </form>
</div>
<div>
    <form method="POST">
        {{ form.hidden_tag() }}
        <p>
            {{ form.username.label }}
            <br>
            {{ form.username(size=32, class="validate") }}
            {% for error in form.username.errors %}
            <span class="error-message" style="color: red;">{{ error }}</span>
            {% endfor %}
        </p>
        <p>
            {{ form.password.label }}
            <br>
            {{ form.password(size=32, class="validate") }}
            {% for error in form.password.errors %}
            <span class="error-message" style="color: red;">{{ error }}</span>
            {% endfor %}
        </p>
        <p>
            {{ form.confirm.label }}
            <br>
            {{ form.confirm(size=32, class="validate") }}
            {% for error in form.confirm.errors %}
            <span class="error-message" style="color: red;">{{ error }}</span>
            {% endfor %}
        </p>
        <p>
            {{ form.submit() }}
        </p>
    </form>
</div>
{% with messages = get_flashed_messages() %}
{% if messages %}
<div class="flash-message-register">
    {% for message in messages %}
    {{ message }}
    {% endfor %}
</div>
{% endif %}
{% endwith %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('input.validate').forEach(function(input) {
            input.addEventListener('input', function() {
                // Получаем родительский <p> и все error-message внутри него
                let p = input.closest('p');
                if (!p) return;
                let errors = p.querySelectorAll('.error-message');
                if (input.value.trim() !== '') {
                    errors.forEach(span => span.style.display = 'none');
                } else {
                    errors.forEach(span => span.style.display = 'inline');
                }
            });
        });
    });
</script>
</body>
<footer>
    <div>
        <h2>
            Здесь будет информация
        </h2>
    </div>
</footer>
</html>
